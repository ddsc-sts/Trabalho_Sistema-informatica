{% extends "base.html" %}
{% block content %}

<h2>Promoções</h2>
<div class="promotions">
  {% for promo in promotions %}
    <div class="promo-card">
      <h4>{{ promo.name }}</h4>
      <p>De: R$ {{ promo.old_price }} <br> Por: R$ {{ promo.price }}</p>
      <a class="btn" href="{{ url_for('product', product_id=promo.id) }}">Comprar</a>
    </div>
  {% endfor %}
</div>

<h2>Produtos</h2>
<div class="products-grid" id="product-list">
  {% for p in products %}
    <article class="card" data-name="{{ p.name }}" data-price="{{ p.price }}">

      <img 
        src="{% if p.image_url %}{% if p.image_url.startswith('http') %}{{ p.image_url }}{% else %}{{ url_for('static', filename='images/' ~ p.image_url) }}{% endif %}{% else %}{{ url_for('static', filename='images/default_product.png') }}{% endif %}"
        alt="{{ p.name }}"
      >

      <h3>{{ p.name }}</h3>
      <p class="price">R$ {{ '%.2f'|format(p.price) }}</p>
      <div class="card-actions">
        <a class="btn" href="{{ url_for('product', product_id=p.id) }}">Ver</a>
        <form action="{{ url_for('add_to_cart', product_id=p.id) }}" method="post" class="inline-form">
          <input type="hidden" name="qty" value="1">
          <button class="btn-ghost">Adicionar</button>
        </form>
      </div>
    </article>
  {% else %}
    <p>Nenhum produto encontrado.</p>
  {% endfor %}
</div>

<script src="{{ url_for('static', filename='js/shop.js') }}"></script>
{% endblock %}
